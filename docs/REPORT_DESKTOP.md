# 🖥️ Airport デスクトップGUI操作 実験報告書

Webブラウザの枠を超え、OSネイティブアプリケーション（計算機、テキストエディタ）を **Vision Only (AI視覚認識)** で操作する実験を行いました。
本実験はLinux環境で行われましたが、アーキテクチャはOS非依存であり、Windows環境への即時適用が可能です。

## 🧪 検証シナリオと結果

### 1. 電卓アプリ操作 (Galculator)
*   **目的**: 特定の数字や記号ボタンを視覚的に識別し、計算を実行する。
*   **操作**: `1` `+` `2` `=` を順にクリック。
*   **スクリーンショット**:
    *   開始時 (Pre): `desktop_screenshots/pre_1767378098.png`
    *   "1" クリック後: `desktop_screenshots/post_1767378100.png`
    *   "+" クリック後: `desktop_screenshots/post_1767378102.png`
    *   計算結果確認: `desktop_screenshots/post_1767378106.png`
*   **結果**: ✅ **成功**
    *   ボタンの位置を正確に特定し、一連のクリック操作を完了しました。
    *   Vision認識: Gemini 2.0 Flashは、ボタン上の記号（+, =）も正確に認識しました。

### 2. テキストエディタ操作 (Mousepad)
*   **目的**: 自由形式の入力エリアへのタイピングとウィンドウ操作。
*   **操作**:
    1.  「白い入力エリア」をクリックしてフォーカス。
    2.  `Hello from Airport Vision Agent!` と入力。
    3.  Enterキーで改行。
    4.  再度入力エリアをクリックし、追加入力。
    5.  ウィンドウ右上の「閉じるボタン（X）」をクリック。
*   **スクリーンショット**:
    *   アプリ起動 (Pre): `desktop_screenshots/pre_1767378156.png`
    *   テキスト入力後: `desktop_screenshots/post_1767378162.png`
    *   ウィンドウ閉じるボタン認識: `desktop_screenshots/pre_1767378206.png`
*   **結果**: ✅ **成功**
    *   **入力エリア特定**: 文字がない状態でも「白い領域」として認識・クリックに成功。
    *   **ウィンドウ制御**: OS標準のウィンドウ装飾（タイトルバーのXボタン）も正確に認識し、アプリケーションを終了させることができました。

## 🔧 技術的アーキテクチャ (Windows移行に向けて)

本実験で確立した `DesktopATC` クラスは、以下のライブラリ構成によりクロスプラットフォーム互換性を確保しています。

| 機能 | 使用ライブラリ | Windowsでの対応 |
| :--- | :--- | :--- |
| **画面キャプチャ** | `pyautogui.screenshot()` | **変更なし** (そのまま動作) |
| **クリック/入力** | `pyautogui.click()`, `write()` | **変更なし** (そのまま動作) |
| **アプリ起動** | `subprocess.Popen()` | コマンドを `.exe` パスに変更のみ |
| **視覚認識** | `VisionCore` (Gemini API) | **変更なし** (OS問わず画像は画像) |

## 📊 今後の展望

今回の成功により、Airportエージェントは **「OS上のあらゆるGUIが見えて、操作できる」** 状態になりました。
次のステップ（Windows環境）では、以下の業務自動化が可能になります。

*   Excel操作（リボンメニューのクリック）
*   レガシー業務アプリの入力
*   Webとデスクトップアプリを行き来するワークフロー（Chromeで検索 → メモ帳にコピペなど）

---
*Verified by Airport Desktop Controller*
