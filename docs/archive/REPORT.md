# ✈️ Airport 自動化エージェント 調査報告書

## 概要
本プロジェクトでは、Webブラウザ操作を自動化するAIエージェント「Airport」を開発し、以下の3つの手法を組み合わせた「ハイブリッド制御」の実効性を検証しました。

1.  **DOM解析**: HTML構造に基づく確実な操作
2.  **画像解析 (OpenCV)**: テンプレートマッチングによる位置特定
3.  **LLM視覚解析 (Gemini 1.5/2.0)**: 自然言語指示による柔軟な操作

## 🧪 検証シナリオと結果

以下の3つのシナリオを連続実行し、すべてのステップで正常動作を確認しました。

### 1. Wikipedia 情報収集
*   **目的**: 検索機能の動作確認
*   **動作**: 検索窓への入力、虫眼鏡アイコンのクリック
*   **結果**: ✅ **成功** (ハイブリッドモードでアイコンを正確にクリック)

### 2. ECサイト (SauceDemo) での購買行動
*   **目的**: 視覚情報のみに頼った操作 (LLM Vision) の実証
*   **動作**:
    1.  ログイン (DOM)
    2.  `"Click the link or title for the Sauce Labs Backpack"` (LLM)
    3.  `"Click the 'Add to cart' button"` (LLM)
*   **結果**: ✅ **成功**
    *   商品選択: 座標 (300, 265) を特定
    *   カート追加: 座標 (384, 490) を特定
    *   **特記事項**: APIのレート制限 (429 Error) に対し、リトライロジックが機能し、最終的に操作を完遂した。

### 3. フォーム入力 (DemoQA)
*   **目的**: 複数フィールドへの正確な入力
*   **結果**: ✅ **成功** (DOMモードで高速に入力完了)

## 📊 技術的成果

### LLM Vision の精度
Google Gemini 2.0 Flash を採用することで、高速かつ高精度な要素特定を実現しました。
以前のバージョンと比較して、抽象的な指示（「バックパックを選んで」など）に対する理解度が向上しています。

### セッション維持型アーキテクチャ
ATCクラスをステートフルな設計にリファクタリングしたことで、ログイン状態を維持したまま、検索→商品選択→決済といった一連のフロー（Workflow）を実行可能になりました。

### 自己修復 (Self-Healing)
LLM APIのエラー時に自動的に待機時間を設けて再試行するリトライロジックを実装し、エージェントの堅牢性 (Robustness) を高めました。

## 📸 エビデンス (スクリーンショット)

| ステップ | 画像 (Pre/Post) | 備考 |
| :--- | :--- | :--- |
| **ECサイト商品選択** | `screenshots/pre_1767375752.png` | AIが「Backpack」を認識 |
| **カート追加** | `screenshots/pre_1767375761.png` | AIが「Add to cart」ボタンを認識 |
| **フォーム入力** | `screenshots/post_1767375772.png` | 入力完了後の状態 |

---
*Verified by Airport Autopilot System*
